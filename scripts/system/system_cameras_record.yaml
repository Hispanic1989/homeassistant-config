---
#
# Record the cameras.
#
system_cameras_record:
  alias: Cameras - Record
  mode: queued
  max: 9999
  max_exceeded: silent

  variables:
    path: "/config/www/recordings/"

  fields:
    prefix:
      description: "A string to be prepended to the filename with an underscore."
    suffix:
      description: "A string to be appended to the filename with an underscore."
    duration:
      description: "The length of the recording in seconds. Default: 60."
    lookback:
      description: "The length in seconds to lookback in time. Default: 10."

  sequence:
    - service: camera.record
      data:
        entity_id: camera.woonkamer
        filename: >-
          {% set filename = path %}
          {% if prefix %}
            {% set filename = filename + prefix + '_' %}
          {% endif %}
          {% set filename = filename + 'woonkamer' %}
          {% if suffix %}
            {% set filename = filename + '_' + suffix %}
          {% endif %}
          {% set filename = filename + '.mp4' %}
          {{ filename }}
        duration: >-
          {% if duration %}{% set duration = duration|int %}{% endif %}
          {% if duration %}
            {{ duration }}
          {% else %}
            60
          {% endif %}
        lookback: >-
          {% if lookback %}{% set lookback = lookback|int %}{% endif %}
          {% if lookback %}
            {{ lookback }}
          {% else %}
            10
          {% endif %}
    - service: camera.record
      data:
        entity_id: camera.lily
        filename: >-
          {% set filename = path %}
          {% if prefix %}
            {% set filename = filename + prefix + '_' %}
          {% endif %}
          {% set filename = filename + 'lily' %}
          {% if suffix %}
            {% set filename = filename + '_' + suffix %}
          {% endif %}
          {% set filename = filename + '.mp4' %}
          {{ filename }}
        duration: >-
          {% if duration %}{% set duration = duration|int %}{% endif %}
          {% if duration %}
            {{ duration }}
          {% else %}
            60
          {% endif %}
        lookback: >-
          {% if lookback %}{% set lookback = lookback|int %}{% endif %}
          {% if lookback %}
            {{ lookback }}
          {% else %}
            10
          {% endif %}
    - service: camera.record
      data:
        entity_id: camera.olivia
        filename: >-
          {% set filename = path %}
          {% if prefix %}
            {% set filename = filename + prefix + '_' %}
          {% endif %}
          {% set filename = filename + 'olivia' %}
          {% if suffix %}
            {% set filename = filename + '_' + suffix %}
          {% endif %}
          {% set filename = filename + '.mp4' %}
          {{ filename }}
        duration: >-
          {% if duration %}{% set duration = duration|int %}{% endif %}
          {% if duration %}
            {{ duration }}
          {% else %}
            60
          {% endif %}
        lookback: >-
          {% if lookback %}{% set lookback = lookback|int %}{% endif %}
          {% if lookback %}
            {{ lookback }}
          {% else %}
            10
          {% endif %}
    - delay:
        seconds: >-
          {% if duration %}{% set duration = duration|int %}{% endif %}
          {% if duration %}
            {{ duration }}
          {% else %}
            60
          {% endif %}
